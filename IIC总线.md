# IIC总线

> IIC是两线式串行总线，它由数据线SDA和时钟线SCL构成，属于半全工串行通信。
>
> 在CPU与被控IC（IC芯片，微型电子器件）之间、IC与IC之间进行双向传送，告诉的IIC总线一般可达400kbs以上。

IIC可分为软件IIC和硬件IIC

* 软件IIC。软件IIC通信指的是用单片机的两个I/O端口模拟IIC，用软件控制管脚状态以模拟IIC通信波形，软件模拟寄存器的波形。
* 硬件IIC。一块硬件电路，硬件IIC对应芯片上的IIC外设，有相应的IIC驱动电路。其使用的IIC管脚也是专用的，硬件IIC直接调用内部寄存器。

**Additional**:

* 硬件IIC的效率远高于软件，而软件IIC由于不受管脚限制，接口比较灵活。
* IIC是<font color=red>半双工通信</font>方式。
* IIC是真正的**多主机总线**，如果两个或更多的主机同时请求总线，可以通过冲突检测和仲裁防止总线数据被破坏。
* 起始和终止信号都是由主机发送的，连接到IIC总线的器件，若具有IIC总线的硬件接口，则很容易检测到起始和终止信号。
* 实际使用中，**一般是单片机作为主机，其他器件作为从机**，单片机先向器件发送信息表示要读取数据，之后转变方向，器件发送数据到单片机。

## 1. IIC通信协议

IIC通信过程由开始、结束、发送、响应、接收五个部分组成。

1. （在发送、接收数据的时候）当SCL为高电平时，SDA不允许变化；当SCL线为低电平时，SDA可以任意0、1变化。
2. （在任意时候）只有在SCL为高电平时，IIC电路才对SDA上的电平（0或1）进行记录，当SCL为低电平，无论SDA是高还是低，IIC都不对SDA采样。





